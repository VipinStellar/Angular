<div class="content-wrapper">
    <div class="content-header" style="margin-top: 57px;">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-xl-4 col-sm-4">
            <h1 class="m-0 text-dark">{{pageTitle}}</h1>
          </div>
        </div>
      </div>
    </div>
    <section class="content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <fieldset class="scheduler-border">
                <legend class="scheduler-border">Advance Search</legend>
                <div class="row">
                  <div class="col-sm-3">
                    <mat-form-field class="example-form-field" style="display:block">
                        <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                        <input matStartDate formControlName="start" placeholder="Start date">
                        <input matEndDate formControlName="end" placeholder="End date">
                        </mat-date-range-input>
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-date-range-picker #picker></mat-date-range-picker>
                    </mat-form-field>
                  </div>
                  <div class="col-sm-3"> 
                    <mat-select [(value)]="selectedType" (selectionChange)="selectOnChange($event)" class="mt-2 table-search form-control form-control-sm" placeholder="Search For">
                      <mat-option *ngFor="let search of searchField" [value]="search.value">
                        {{search.name}}
                      </mat-option>
                    </mat-select>
                  </div>
                  <div class="col-sm-3" *ngIf="searchfieldName !=null && searchfieldName !='' &&  searchfieldName !='branch_id'">
                    <input [(ngModel)]="term" type="text" class="mt-2 form-control-sm table-search form-control" />
                  </div>
                  <div class="col-sm-3" *ngIf="searchfieldName =='branch_id'">
                    <mat-select [(value)]="selectedBranch" (selectionChange)="dropDownChamge($event)"
                      class="mt-2 table-search form-control form-control-sm" placeholder="Select branch List">
                      <mat-option *ngFor="let search of branchList" [value]="search['id']">
                        {{search['branch_name']}}
                      </mat-option>
                    </mat-select>
                  </div><br><br>
                  
                  <div class="col-sm-3">
                    <button class="mt-2 btn btn-primary btn-sm" (click)="_search()">Search</button>&nbsp;
                    <button class="mt-2 btn btn-default btn-sm" (click)="reset()">Reset</button>&nbsp;
                  </div>
                </div>
              </fieldset>
          </div>
          <div class="col-12">
            <table mat-table class="mat-elevation-z8" matSort (matSortChange)="sortData($event)" matSortDirection="asc"
              [dataSource]="paymentList" style="width: 100%;">
              <ng-container matColumnDef="sr_no">
                <th mat-header-cell *matHeaderCellDef>Sr. No.</th>
                <td mat-cell *matCellDef="let element; let i = index;">{{ (paginator.pageIndex * paginator.pageSize) + (i + 1) }}</td>
              </ng-container>
              <ng-container matColumnDef="job_id">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Job ID</th>
                <td mat-cell *matCellDef="let element">{{element?.job_id}}</td>
              </ng-container>
  
              <ng-container matColumnDef="firstname">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Client Name</th>
                <td mat-cell *matCellDef="let element"> {{element?.firstname}} </td>
              </ng-container>
              <ng-container matColumnDef="phone">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Phone</th>
                <td mat-cell *matCellDef="let element"> {{element?.phone}} </td>
              </ng-container>
              <ng-container matColumnDef="payment_amount">
                <th mat-header-cell *matHeaderCellDef>Amount</th>
                <td mat-cell *matCellDef="let element"> {{element?.payment_amount | currency:"INR":"symbol"}} 
              </td>              
              </ng-container>
              <ng-container matColumnDef="order_no">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Order NO</th>  
                <td mat-cell *matCellDef="let element">{{ element?.order_no }}</td>
              </ng-container>
              <ng-container matColumnDef="invoice_no">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Invoice No</th>  
                <td mat-cell *matCellDef="let element"><a href="javascript:void(0)" (click)="viewTxnDetails(element)">{{ element?.invoice_no }} </a></td>
              </ng-container>    
              <ng-container matColumnDef="payment_timestamp">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Payment On</th>
                <td mat-cell *matCellDef="let element"> {{element?.payment_timestamp | date:'MMM dd, yyyy  hh:mm a' }} </td>
              </ng-container>
              <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef>Action</th>
                <td mat-cell *matCellDef="let element"> 
                  <ul class="navbar-nav mr-auto">
                    <li class="nav-item" routerLinkActive="active" >
                      <a class="nav-link" #createPlanmenuTrigger="matMenuTrigger" [matMenuTriggerFor]="createPlan"><mat-icon>more_vert</mat-icon></a>
                      <mat-menu #createPlan="matMenu">
                        <a class="btn" mat-menu-item href="javascript:void(0)" *ngIf="element['invoice_no'] == null" (click)="generateInvoice(element)"
                          >Generate Invoice</a>                
                        <a class="btn" mat-menu-item href="javascript:void(0)" *ngIf="element['invoice_no'] != null && element['irn_status'] == 0" (click)="generateIrn(element)"
                        >Generate Irn</a>
                        <a class="btn" mat-menu-item target="_blank"  href="{{ PDFurl }}view-invoice/{{element['invoiceId']+'/'+element['id']+'?show=all'}}" *ngIf="element['invoice_no'] != null && element['irn_status'] != 0" >
                        Download Invoice</a>
                      </mat-menu>
                    </li>
                  </ul>
                  <!-- <a class=" btn-danger"  href="javascript:void(0)" *ngIf="element['invoice_no'] != null && element['irn_status'] == 0" (click)="generateIrn(element)"
                  >Generate Irn</a> -->
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
  
            <mat-paginator #paginator [length]="totalRows" [pageIndex]="currentPage" [pageSize]="pageSize"
              [pageSizeOptions]="pageSizeOptions" (page)="pageChanged($event)" aria-label="Select page">
            </mat-paginator>
  
          </div>
        </div>
      </div>
    </section>
  </div>